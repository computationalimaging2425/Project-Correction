% File: red_diff.tex

\subsection{RED-Diff: Regularization by Denoising Diffusion}

% Che cosa fa RED-Diff
\begin{frame}{Che cosa fa RED-Diff}
  RED-Diff risolve problemi inversi rumorosi combinando:
  \begin{itemize}
    \item Un termine di fidelity per avvicinare la ricostruzione alle osservazioni $y$,
    \item Un regolarizzatore basato sui denoiser multiscala di un modello di diffusione pre-addestrato,
  \end{itemize}
  integrando vincoli a diversi livelli di dettaglio per preservare sia le strutture globali che i dettagli fini.
\end{frame}

% Implementazione di RED-Diff
\begin{frame}[fragile]{Implementazione di RED-Diff}
  L'algoritmo si articola in tre fasi principali:
  \begin{enumerate}
    \item \textbf{Inizializzazione:} $\mu^{(0)} = K^T y$.
    \item \textbf{Ottimizzazione iterativa:}
      Per ogni passo $i=1,\dots,N$ e per ogni livello di rumore $t=1,\dots,T$:
      \begin{enumerate}
        \item Campiona $\epsilon\sim\mathcal{N}(0,I)$ e costruisci
          \[x_t = \sqrt{\alpha_t}\,\mu^{(i-1)} + \sigma_t\,\epsilon.\]
        \item Predici il rumore $\hat\epsilon = \epsilon_\theta(x_t,t)$.
        \item Calcola i contributi:
          \[
            L_{\mathrm{fid}} = \tfrac{1}{2\sigma_y^2}\|K\mu^{(i-1)} - y\|^2,
            \quad
            L_{\mathrm{reg}} = w_t\,\|\hat\epsilon - \epsilon\|^2,
            \quad w_t = 1/\mathrm{SNR}_t.
          \]
      \end{enumerate}
      Quindi aggiorna $\mu^{(i)}$ con Adam minimizzando $L_{\mathrm{fid}} + \lambda\,L_{\mathrm{reg}}$.
    \item \textbf{Output:} la stima finale $\mu^{(N)}$.
  \end{enumerate}
\end{frame}

% Risultati finali di RED-Diff
\begin{frame}{Risultati finali}
  \begin{itemize}
    \item Su test di deblurring, RED-Diff raggiunge PSNR medio di $\approx19.4\,$dB, SSIM di $\approx0.64$.
    \item Confrontato a metodi senza prior diffusivo, migliora la qualità ricostruttiva di $>2\,$dB di PSNR.
    \item Le ricostruzioni mostrano dettagli più nitidi e minor artefatti, grazie all’integrazione multiscala del denoising.
  \end{itemize}
\end{frame}
