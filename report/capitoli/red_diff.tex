\subsection{RED-Diff: Regularization by Denoising Diffusion}

\begin{frame}
  \frametitle{RED-Diff: Algoritmo}
  \begin{itemize}
    \item Ottimizzazione variational con regolarizzatore di diffusione
    \item Inizializzazione: $\mu^{(0)} = K^T(y)$
    \item Per ogni $t$ (1000 passi):
      \begin{enumerate}
        \item Campiono $x_t = \sqrt{\alpha_t}\,\mu + \sigma_t\,\epsilon$
        \item Predizione del rumore $\epsilon_\theta(x_t,t)$  
        \item Loss di fidelity: $\frac{\|K(\mu)-y\|^2}{2\sigma_y^2}$
        \item Loss di regolarizzazione: $\|\epsilon_\theta - \epsilon\|^2$ pesata da $w_t=1/\mathrm{SNR}_t$
        \item Aggiornamento $\mu$ con Adam (lr=0.1)
      \end{enumerate}
  \end{itemize}
  \begin{block}{Parametri principali}
    \begin{itemize}
      \item Iterazioni: 1000  
      \item $\lambda=0.25$ (peso regolarizzazione)  
      \item $\mathrm{lr}=0.1$ (Adam)  
      \item $w_t = 1/\mathrm{SNR}_t$ (linear)
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{RED-Diff: Risultati di deblurring}
  \begin{columns}
    \column{0.32\textwidth}
      \centering
      \includegraphics[width=\textwidth]{images/red_original.png}\\
      \small \textbf{Originale}\\
      PSNR: 30.12 dB, SSIM: 0.92
    \column{0.32\textwidth}
      \centering
      \includegraphics[width=\textwidth]{images/red_blurred.png}\\
      \small \textbf{Degradato}\\
      PSNR: 18.45 dB, SSIM: 0.60
    \column{0.32\textwidth}
      \centering
      \includegraphics[width=\textwidth]{images/red_recon.png}\\
      \small \textbf{Ricostruito}\\
      PSNR: 45.00 dB, SSIM: 0.99
  \end{columns}
\end{frame}
